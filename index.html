<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>TwitterChallenge</title>
	</head>
	<body>
		<div id="login">
			<form action="/" id="loginform">
				<h1>Entrer un Login</h1>
				<input type="text" name="login" id="username">
				<input type="submit" value="Enregistrer">
			</form>
		</div>
		<div id="user"></div>
		<div id="twitterstream" style="height: auto; width: 90%; border: solid 1px black; position:relative;" ></div>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
		<script type="text/javascript" src="/socket.io/socket.io.js" ></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.0.0/pixi.min.js"></script>
		<script type="text/javascript" >
		var style = {
			backgroundColor: 0x1099bb,
		}
			var renderer = PIXI.autoDetectRenderer(800, 600, style);
			document.body.appendChild(renderer.view);

			// create the root of the scene graph
			var stage = new PIXI.Container();
			var height = 90;

			/**
			*
			**/

			var socket = io.connect('http://localhost:8080');

			/**
			*
			**/

			$('#loginform').submit(function(event){
				event.preventDefault();
				socket.emit('login', {username: $('#username').val()
				})
			});

			/**
			*
			**/

			socket.on('logged', function(){
				$('#login').fadeOut();
			});

			/**
			*
			**/

			socket.on('newuser', function(user){
				$('#user').append('<p id="'+ user.username +'" ><em>' + user.username + ' a rejoint le TwitterChallenge !</em></p>');
			});

			/**
			*
			**/

			socket.on('decoUser', function(user){
				$('#'+ user.username +'').remove();
			});

			/**
			* retirer ou modifier tweet.user.name Ã  cause des warning
			**/

			socket.on('tweet', function(tweet){
				var basicText = new PIXI.Text( '<p>'+tweet.user.name + ' : ' + tweet.text + '</p>');
				basicText.x = 30;
				basicText.y = height += 30;

				stage.addChild(basicText);


				// start animating
				animate();
				
			});


			function animate() {

				

				// render the root container
				renderer.render(stage);
			}

		</script>
	</body>
</html>